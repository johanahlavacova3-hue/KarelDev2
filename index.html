<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<title>Karel The Robot 25'</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<!-- -----------------------------
     STARTOVAC√ç OBRAZOVKA
---------------------------------->
<div id="start-screen">
  <h1>KAREL THE ROBOT 25'</h1>
  <p>Zvol m√≥d hry:</p>
  <div class="mode-buttons">
    <button id="mode-code">Code Mode</button>
    <button id="mode-maze">Maze Mode</button>
  </div>
</div>

<!-- -----------------------------
     P≈ÆVODN√ç OBSAH HRY
---------------------------------->
<div id="game-screen" class="hidden">
  <div class="sidebar">
    <textarea id="editor" placeholder="Napi≈° sv≈Øj k√≥d...
nap≈ô√≠klad:
move();
turnLeft();
putBeeper();
move();"></textarea>
    <button id="runBtn"></button>
  </div>

  <div id="grid"></div>
</div>

<script>
// ---------------------------------------------------
// üü© 1. P≈ôep√≠n√°n√≠ m√≥d≈Ø
// ---------------------------------------------------
const startScreen = document.getElementById('start-screen');
const gameScreen = document.getElementById('game-screen');
const modeCodeBtn = document.getElementById('mode-code');
const modeMazeBtn = document.getElementById('mode-maze');
let currentMode = 'code'; // v√Ωchoz√≠

modeCodeBtn.addEventListener('click', () => {
  currentMode = 'code';
  startScreen.classList.add('hidden');
  gameScreen.classList.remove('hidden');
  resetWorld();
});

modeMazeBtn.addEventListener('click', () => {
  currentMode = 'maze';
  startScreen.classList.add('hidden');
  gameScreen.classList.remove('hidden');
  startMazeWorld();
});

// ---------------------------------------------------
// üü© 2. Funkce pro vytvo≈ôen√≠ bludi≈°tƒõ
// ---------------------------------------------------
function startMazeWorld() {
  resetWorld();

  // jednoduch√© ‚Äûzdi‚Äú ve vybran√Ωch bu≈àk√°ch
  const wallIndices = [5, 6, 7, 15, 16, 22];
  wallIndices.forEach(i => {
    grid.children[i].classList.add('wall');
  });
}

// ---------------------------------------------------
// üü© 3. Roz≈°√≠≈ôen√≠ pohybu v Maze m√≥du (kolize se zd√≠)
// ---------------------------------------------------
const originalMove = move;
move = function() {
  if (currentMode === 'maze') {
    let dx = 0, dy = 0;
    if (dir === 'right') dx = 1;
    if (dir === 'left') dx = -1;
    if (dir === 'up') dy = -1;
    if (dir === 'down') dy = 1;
    const newX = posX + dx, newY = posY + dy;
    if (newX < 0 || newX >= GRID_COLS || newY < 0 || newY >= GRID_ROWS) return;
    const targetCell = grid.children[newY * GRID_COLS + newX];
    if (targetCell.classList.contains('wall')) return; // zabr√°n√≠ pr≈Øchodu
    grid.children[posY * GRID_COLS + posX].removeChild(robot);
    posX = newX; posY = newY;
    grid.children[posY * GRID_COLS + posX].appendChild(robot);
  } else {
    originalMove(); // bƒõ≈æn√© chov√°n√≠ v Code Mode
  }
};
</script>

</body>
</html>
